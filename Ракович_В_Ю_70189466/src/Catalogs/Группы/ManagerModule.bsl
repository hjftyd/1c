// Получить список студентов группы
Функция ПолучитьСтудентовГруппы(Группа) Экспорт
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    Студенты.Ссылка,
    |    Студенты.Наименование,
    |    Студенты.ДатаРождения,
    |    Студенты.ГруппаЗдоровья
    |ИЗ
    |    Справочник.Студенты КАК Студенты
    |ГДЕ
    |    Студенты.ПричинаПосещения = &ПричинаПосещения
    |    И Студенты.Статус = ""Активный""
    |УПОРЯДОЧИТЬ ПО
    |    Студенты.Наименование";
    
    Запрос.УстановитьПараметр("ПричинаПосещения", Группа);
    Возврат Запрос.Выполнить().Выгрузить();
    
КонецФункции

// Расчет статистики по группе
Процедура РассчитатьСтатистикуГруппы(Группа) Экспорт
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    КОЛИЧЕСТВО(Студенты.Ссылка) КАК КоличествоСтудентов,
    |    СРЕДНЕЕ(ГОД(ТекущаяДата()) - ГОД(Студенты.ДатаРождения)) КАК СреднийВозраст,
    |    СУММА(ВЫБОР
    |        КОГДА Студенты.ГруппаЗдоровья = ""I""
    |            ТОГДА 1
    |        ИНАЧЕ 0
    |    КОНЕЦ) / КОЛИЧЕСТВО(Студенты.Ссылка) * 100 КАК ПроцентЗдоровых
    |ИЗ
    |    Справочник.Студенты КАК Студенты
    |ГДЕ
    |    Студенты.ПричинаПосещения = &ПричинаПосещения
    |    И Студенты.Статус = ""Активный""";
    
    Запрос.УстановитьПараметр("ПричинаПосещения", Группа);
    Результат = Запрос.Выполнить().Выбрать();
    Результат.Следующий();
    
    ЭлементГруппы = Группа.ПолучитьОбъект();
    ЭлементГруппы.КоличествоСтудентов = Результат.КоличествоСтудентов;
    ЭлементГруппы.СреднийВозраст = Результат.СреднийВозраст;
    ЭлементГруппы.ПроцентСЗдоровойГруппой = Результат.ПроцентЗдоровых;
    ЭлементГруппы.Записать();
    
КонецПроцедуры