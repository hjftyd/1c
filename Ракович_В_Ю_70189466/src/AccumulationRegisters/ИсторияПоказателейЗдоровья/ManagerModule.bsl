// Получить историю показателя для студента
Функция ПолучитьИсториюПоказателя(Студент, Показатель, ДатаНачала, ДатаОкончания) Экспорт
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |    ИсторияПоказателейЗдоровья.ПериодИзмерения,
    |    ИсторияПоказателейЗдоровья.Значение,
    |    ИсторияПоказателейЗдоровья.ОтклонениеОтНормы,
    |    ИсторияПоказателейЗдоровья.Комментарий
    |ИЗ
    |    РегистрНакопления.ИсторияПоказателейЗдоровья КАК ИсторияПоказателейЗдоровья
    |ГДЕ
    |    ИсторияПоказателейЗдоровья.Студент = &Студент
    |    И ИсторияПоказателейЗдоровья.Показатель = &Показатель
    |    И ИсторияПоказателейЗдоровья.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
    |УПОРЯДОЧИТЬ ПО
    |    ИсторияПоказателейЗдоровья.Период";
    
    Запрос.УстановитьПараметр("Студент", Студент);
    Запрос.УстановитьПараметр("Показатель", Показатель);
    Запрос.УстановитьПараметр("ДатаНачала", ДатаНачала);
    Запрос.УстановитьПараметр("ДатаОкончания", ДатаОкончания);
    
    Возврат Запрос.Выполнить().Выгрузить();
    
КонецФункции

// Получить последнее значение показателя
Функция ПолучитьПоследнееЗначение(Студент, Показатель) Экспорт
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ ВЕРХ 1
    |    ИсторияПоказателейЗдоровья.Значение,
    |    ИсторияПоказателейЗдоровья.ПериодИзмерения
    |ИЗ
    |    РегистрНакопления.ИсторияПоказателейЗдоровья КАК ИсторияПоказателейЗдоровья
    |ГДЕ
    |    ИсторияПоказателейЗдоровья.Студент = &Студент
    |    И ИсторияПоказателейЗдоровья.Показатель = &Показатель
    |УПОРЯДОЧИТЬ ПО
    |    ИсторияПоказателейЗдоровья.Период УБЫВ";
    
    Запрос.УстановитьПараметр("Студент", Студент);
    Запрос.УстановитьПараметр("Показатель", Показатель);
    
    Результат = Запрос.Выполнить();
    Если Не Результат.Пустой() Тогда
        Выборка = Результат.Выбрать();
        Выборка.Следующий();
        Возврат Новый Структура("Значение,ПериодИзмерения", Выборка.Значение, Выборка.Период);
    КонецЕсли;
    
    Возврат Неопределено;
    
КонецФункции